SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
CREATE PROC [dbo].[CO_SP_SELECT_BUSQUEDA_EGRESO_BODEGA]
@CO_EMP_RUC CHAR(13),
@FECHA1 DATETIME,
@FECHA2 DATETIME
AS
SELECT EgresoID, Numero, Fecha, Estado, Usuario,
		(SELECT CO_BOD_NOM FROM dbo.CO_BODEGA WHERE CO_BOD_COD=dbo.CO_EGRESO.BodegaOrigenID) AS BodegaOrigen,
		(SELECT CO_BOD_NOM FROM dbo.CO_BODEGA WHERE CO_BOD_COD=dbo.CO_EGRESO.BodegaDestinoID) AS BodegaDestino
FROM dbo.CO_EGRESO
WHERE CO_EMP_RUC=@CO_EMP_RUC AND (Fecha BETWEEN @FECHA1 AND @FECHA2)
AND Estado<>'ANULADA'
order by Fecha
GO
